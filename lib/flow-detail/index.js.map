{"version":3,"sources":["../../src/components/flow-detail/index.jsx"],"names":["FlowDetail","props","onTabChange","renderTabs","renderApprove","renderInfo","renderHeader","TabsComponent","onOkSuccess","onRejectSuccess","onTransferSuccess","data","tabs","tabProps","rest","fullScreen","setFullScreen","visible","setVisible","el","document","onfullscreenchange","fullscreenElement","_tabs","name","key","render","tabItem","_onTabChange","_onFullScreen","current","requestFullscreen","_onExitFullScreen","exitFullscreen","_onTransfer","_onOk","_onReject","_onTransferOk","_onTransferCancel","_renderApprove","_renderHeader","title","_renderTabs","Tabs","FlowTabs","filter","d","map"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef, useCallback } from \"react\";\r\nimport {\r\n  FlowViewer,\r\n  FlowRecord,\r\n  FlowTabs,\r\n  TabPane,\r\n  FlowActionButtons,\r\n  FlowTransferModal,\r\n  FlowFullScreen,\r\n} from \"../index\";\r\nimport \"../flow-viewer/style\";\r\nimport \"../flow-record/style\";\r\nimport \"../flow-action-buttons/style\";\r\nimport { Button, Row, Col, Input, Modal, Select, Form } from \"antd\";\r\n\r\nimport { FullscreenOutlined, FullscreenExitOutlined } from \"@ant-design/icons\";\r\n\r\nexport default function FlowDetail(props) {\r\n  const {\r\n    onTabChange,\r\n    renderTabs,\r\n    renderApprove,\r\n    renderInfo,\r\n    renderHeader,\r\n    TabsComponent,\r\n    onOkSuccess,\r\n    onRejectSuccess,\r\n    onTransferSuccess,\r\n    data,\r\n    tabs = [],\r\n    tabProps = {},\r\n    ...rest\r\n  } = props;\r\n\r\n  const [fullScreen, setFullScreen] = useState(false);\r\n  const [visible, setVisible] = useState(false);\r\n  const el = useRef();\r\n\r\n  useEffect(() => {\r\n    document.onfullscreenchange = () => {\r\n      setFullScreen(document.fullscreenElement !== null);\r\n    };\r\n    return () => {};\r\n  }, []);\r\n\r\n  const _tabs = useRef([\r\n    {\r\n      name: \"审批信息\",\r\n      key: \"approve_form\",\r\n      render: renderInfo,\r\n    },\r\n    {\r\n      name: \"审批日志\",\r\n      key: \"approve_records\",\r\n      render: (tabItem, data) => <FlowRecord data={data} />,\r\n    },\r\n    {\r\n      name: \"流程图\",\r\n      key: \"task_viewer\",\r\n      render: (tabItem, data) => <FlowViewer data={data} />,\r\n    },\r\n    ...tabs,\r\n  ]);\r\n\r\n  const _onTabChange = (key) => {\r\n    onTabChange && onTabChange(key);\r\n  };\r\n\r\n  const _onFullScreen = () => {\r\n    el.current.requestFullscreen();\r\n  };\r\n\r\n  const _onExitFullScreen = () => {\r\n    document.exitFullscreen();\r\n  };\r\n\r\n  const _onTransfer = () => {\r\n    setVisible(true);\r\n  };\r\n\r\n  const _onOk = () => {\r\n    if (typeof onOkSuccess === \"function\") onOkSuccess();\r\n  };\r\n\r\n  const _onReject = () => {\r\n    if (typeof onRejectSuccess === \"function\") onRejectSuccess();\r\n  };\r\n\r\n  const _onTransferOk = () => {\r\n    if (typeof onTransferSuccess === \"function\") onTransferSuccess();\r\n  };\r\n\r\n  const _onTransferCancel = () => {\r\n    setVisible(false);\r\n  };\r\n\r\n  const _renderApprove = () => {\r\n    if (typeof renderApprove === \"function\") return renderApprove();\r\n    return (\r\n      <div className=\"flow-approve-detault\">\r\n        <div className=\"flow-remark-label\">备注说明：</div>\r\n        <div className=\"flow-remark-field\">\r\n          <Input.TextArea placeholder=\"请输入\" />\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const _renderHeader = () => {\r\n    if (typeof renderHeader === \"function\") return renderHeader(props);\r\n    return (\r\n      <div className=\"flow-detail-header\">\r\n        <div className=\"flow-detail-top\">\r\n          <div className=\"flow-detail-title\">{data.title}</div>\r\n          <FlowFullScreen el={el}/>\r\n        </div>\r\n        <div className=\"flow-approve\">{_renderApprove()}</div>\r\n\r\n        <FlowActionButtons\r\n          data={data}\r\n          onTransfer={_onTransfer}\r\n          onOk={_onOk}\r\n          onReject={_onReject}\r\n          {...rest}\r\n        />\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const _renderTabs = () => {\r\n    if (typeof renderTabs === \"function\") return renderTabs(props);\r\n    const Tabs = TabsComponent || FlowTabs;\r\n    return (\r\n      <Tabs\r\n        defaultActiveKey={_tabs?.current[0]?.key}\r\n        onChange={_onTabChange}\r\n        {...tabProps}\r\n      >\r\n        {_tabs.current?.filter(d => d.render)?.map((d) => (\r\n          <TabPane tab={d.name} key={d.key}>\r\n            {d.render && d.render(d, data)}\r\n          </TabPane>\r\n        ))}\r\n      </Tabs>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"flow-detail\" ref={el}>\r\n      {_renderHeader()}\r\n      {_renderTabs()}\r\n      <FlowTransferModal\r\n        visible={visible}\r\n        onOk={_onTransferOk}\r\n        onCancel={_onTransferCancel}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"file":"index.js"}