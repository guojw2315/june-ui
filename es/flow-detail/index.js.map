{"version":3,"sources":["../../src/components/flow-detail/index.jsx"],"names":["React","useEffect","useState","useRef","useCallback","FlowViewer","FlowRecord","FlowTabs","TabPane","FlowActionButtons","FlowTransferModal","FlowFullScreen","FullscreenOutlined","FullscreenExitOutlined","FlowDetail","props","onTabChange","renderTabs","renderApprove","renderInfo","renderHeader","TabsComponent","onOkSuccess","onRejectSuccess","onTransferSuccess","data","tabs","tabProps","rest","fullScreen","setFullScreen","visible","setVisible","el","document","onfullscreenchange","fullscreenElement","_tabs","name","key","render","tabItem","_onTabChange","_onFullScreen","current","requestFullscreen","_onExitFullScreen","exitFullscreen","_onTransfer","_onOk","_onReject","_onTransferOk","_onTransferCancel","_renderApprove","_renderHeader","title","_renderTabs","Tabs","filter","d","map"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef, useCallback } from \"react\";\nimport {\n  FlowViewer,\n  FlowRecord,\n  FlowTabs,\n  TabPane,\n  FlowActionButtons,\n  FlowTransferModal,\n  FlowFullScreen,\n} from \"../index\";\nimport \"../flow-viewer/style\";\nimport \"../flow-record/style\";\nimport \"../flow-action-buttons/style\";\nimport { Button, Row, Col, Input, Modal, Select, Form } from \"antd\";\n\nimport { FullscreenOutlined, FullscreenExitOutlined } from \"@ant-design/icons\";\n\nexport default function FlowDetail(props) {\n  const {\n    onTabChange,\n    renderTabs,\n    renderApprove,\n    renderInfo,\n    renderHeader,\n    TabsComponent,\n    onOkSuccess,\n    onRejectSuccess,\n    onTransferSuccess,\n    data,\n    tabs = [],\n    tabProps = {},\n    ...rest\n  } = props;\n\n  const [fullScreen, setFullScreen] = useState(false);\n  const [visible, setVisible] = useState(false);\n  const el = useRef();\n\n  useEffect(() => {\n    document.onfullscreenchange = () => {\n      setFullScreen(document.fullscreenElement !== null);\n    };\n    return () => {};\n  }, []);\n\n  const _tabs = useRef([\n    {\n      name: \"审批信息\",\n      key: \"approve_form\",\n      render: renderInfo,\n    },\n    {\n      name: \"审批日志\",\n      key: \"approve_records\",\n      render: (tabItem, data) => <FlowRecord data={data} />,\n    },\n    {\n      name: \"流程图\",\n      key: \"task_viewer\",\n      render: (tabItem, data) => <FlowViewer data={data} />,\n    },\n    ...tabs,\n  ]);\n\n  const _onTabChange = (key) => {\n    onTabChange && onTabChange(key);\n  };\n\n  const _onFullScreen = () => {\n    el.current.requestFullscreen();\n  };\n\n  const _onExitFullScreen = () => {\n    document.exitFullscreen();\n  };\n\n  const _onTransfer = () => {\n    setVisible(true);\n  };\n\n  const _onOk = () => {\n    if (typeof onOkSuccess === \"function\") onOkSuccess();\n  };\n\n  const _onReject = () => {\n    if (typeof onRejectSuccess === \"function\") onRejectSuccess();\n  };\n\n  const _onTransferOk = () => {\n    if (typeof onTransferSuccess === \"function\") onTransferSuccess();\n  };\n\n  const _onTransferCancel = () => {\n    setVisible(false);\n  };\n\n  const _renderApprove = () => {\n    if (typeof renderApprove === \"function\") return renderApprove();\n    return (\n      <div className=\"flow-approve-detault\">\n        <div className=\"flow-remark-label\">备注说明：</div>\n        <div className=\"flow-remark-field\">\n          <Input.TextArea placeholder=\"请输入\" />\n        </div>\n      </div>\n    );\n  };\n\n  const _renderHeader = () => {\n    if (typeof renderHeader === \"function\") return renderHeader(props);\n    return (\n      <div className=\"flow-detail-header\">\n        <div className=\"flow-detail-top\">\n          <div className=\"flow-detail-title\">{data.title}</div>\n          <FlowFullScreen el={el}/>\n        </div>\n        <div className=\"flow-approve\">{_renderApprove()}</div>\n\n        <FlowActionButtons\n          data={data}\n          onTransfer={_onTransfer}\n          onOk={_onOk}\n          onReject={_onReject}\n          {...rest}\n        />\n      </div>\n    );\n  };\n\n  const _renderTabs = () => {\n    if (typeof renderTabs === \"function\") return renderTabs(props);\n    const Tabs = TabsComponent || FlowTabs;\n    return (\n      <Tabs\n        defaultActiveKey={_tabs?.current[0]?.key}\n        onChange={_onTabChange}\n        {...tabProps}\n      >\n        {_tabs.current?.filter(d => d.render)?.map((d) => (\n          <TabPane tab={d.name} key={d.key}>\n            {d.render && d.render(d, data)}\n          </TabPane>\n        ))}\n      </Tabs>\n    );\n  };\n\n  return (\n    <div className=\"flow-detail\" ref={el}>\n      {_renderHeader()}\n      {_renderTabs()}\n      <FlowTransferModal\n        visible={visible}\n        onOk={_onTransferOk}\n        onCancel={_onTransferCancel}\n      />\n    </div>\n  );\n}\n"],"file":"index.js"}