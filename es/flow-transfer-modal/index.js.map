{"version":3,"sources":["../../src/components/flow-transfer-modal/index.jsx"],"names":["React","useEffect","useState","useRef","useCallback","_debounce","api","layout","labelCol","span","wrapperCol","tailLayout","offset","FlowTransferModal","props","visible","remark","setRemark","request","onOk","onCancel","onModelFormChange","runTimeTasks","useForm","form","targetUserList","setTargetUserList","loading","setLoading","setFieldsValue","reason","length","taskIds","taskId","_onOk","validateFields","values","method","url","taskTransfer","data","res","console","log","resetFields","success","_onSearch","val","userList","_onChange","changedValues","allValues","remember","required","message","map","d","i","id","name","login","nodeName","userNames"],"mappings":";;;;;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,EAAqCC,MAArC,EAA6CC,WAA7C,QAAgE,OAAhE;AAGA,OAAOC,SAAP,MAAsB,iBAAtB;AACA,OAAOC,GAAP,MAAgB,QAAhB;AAEA,IAAMC,MAAM,GAAG;AACbC,EAAAA,QAAQ,EAAE;AAAEC,IAAAA,IAAI,EAAE;AAAR,GADG;AAEbC,EAAAA,UAAU,EAAE;AAAED,IAAAA,IAAI,EAAE;AAAR;AAFC,CAAf;AAKA,IAAME,UAAU,GAAG;AACjBD,EAAAA,UAAU,EAAE;AAAEE,IAAAA,MAAM,EAAE,CAAV;AAAaH,IAAAA,IAAI,EAAE;AAAnB;AADK,CAAnB;AAIA,eAAe,SAASI,iBAAT,CAA2BC,KAA3B,EAAkC;AAAA,MAE7CC,OAF6C,GAU3CD,KAV2C,CAE7CC,OAF6C;AAAA,MAG7CC,MAH6C,GAU3CF,KAV2C,CAG7CE,MAH6C;AAAA,MAI7CC,SAJ6C,GAU3CH,KAV2C,CAI7CG,SAJ6C;AAAA,MAK7CC,OAL6C,GAU3CJ,KAV2C,CAK7CI,OAL6C;AAAA,MAM7CC,IAN6C,GAU3CL,KAV2C,CAM7CK,IAN6C;AAAA,MAO7CC,QAP6C,GAU3CN,KAV2C,CAO7CM,QAP6C;AAAA,MAQ7CC,iBAR6C,GAU3CP,KAV2C,CAQ7CO,iBAR6C;AAAA,4BAU3CP,KAV2C,CAS7CQ,YAT6C;AAAA,MAS7CA,YAT6C,oCAS9B,EAT8B;;AAAA,sBAYhC,MAAKC,OAAL,EAZgC;AAAA,MAYxCC,IAZwC;;AAAA,kBAaHtB,QAAQ,CAAC,EAAD,CAbL;AAAA,MAaxCuB,cAbwC;AAAA,MAaxBC,iBAbwB;;AAAA,mBAcjBxB,QAAQ,CAAC,KAAD,CAdS;AAAA,MAcxCyB,OAdwC;AAAA,MAc/BC,UAd+B;;AAgB/C3B,EAAAA,SAAS,CAAC,YAAM;AACd,QAAIc,OAAJ,EAAa,CACZ;;AACD,WAAO,YAAM,CAAE,CAAf;AACD,GAJQ,EAIN,CAACA,OAAD,CAJM,CAAT;AAMAd,EAAAA,SAAS,CAAC,YAAM;AACduB,IAAAA,IAAI,CAACK,cAAL,CAAoB;AAAEC,MAAAA,MAAM,EAAEd;AAAV,KAApB;AACA,WAAO,YAAM,CAAE,CAAf;AACD,GAHQ,EAGN,CAACA,MAAD,CAHM,CAAT;AAKAf,EAAAA,SAAS,CAAC,YAAM;AACd,QAAIqB,YAAY,CAACS,MAAjB,EAAyB;AAAA;;AACvB;AACAP,MAAAA,IAAI,CAACK,cAAL,CAAoB;AAAEG,QAAAA,OAAO,EAAE,mBAACV,YAAY,CAAC,CAAD,CAAb,mDAAC,eAAiBW,MAAlB;AAAX,OAApB;AACD;;AACD,WAAO,YAAM,CAAE,CAAf;AACD,GANQ,EAMN,CAACX,YAAD,CANM,CAAT;;AAQA,MAAMY,KAAK;AAAA,wEAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACRhB,OADQ;AAAA;AAAA;AAAA;;AAAA;AAGRU,cAAAA,UAAU,CAAC,IAAD,CAAV;AAHQ;AAAA,qBAIaJ,IAAI,CAACW,cAAL,EAJb;;AAAA;AAIFC,cAAAA,MAJE;AAAA;AAAA,qBAKUlB,OAAO,CAAC;AACxBmB,gBAAAA,MAAM,EAAE,MADgB;AAExBC,gBAAAA,GAAG,EAAEhC,GAAG,CAACiC,YAAJ,EAFmB;AAGxBC,gBAAAA,IAAI,oBAAOJ,MAAP;AAHoB,eAAD,CALjB;;AAAA;AAKFK,cAAAA,GALE;AAURC,cAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ,EAAuBP,MAAvB;AACAZ,cAAAA,IAAI,CAACoB,WAAL;;AACA,uBAAQC,OAAR,CAAgBJ,GAAG,CAACD,IAAJ,CAASA,IAAzB;;AACA,kBAAI,OAAOrB,IAAP,KAAgB,UAApB,EAAgCA,IAAI,CAACiB,MAAD,CAAJ,CAbxB,CAcR;;AAdQ;AAAA;;AAAA;AAAA;AAAA;AAgBRM,cAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ;;AAhBQ;AAAA;AAkBRf,cAAAA,UAAU,CAAC,KAAD,CAAV;AAlBQ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAALM,KAAK;AAAA;AAAA;AAAA,KAAX;;AAuBA,MAAMY,SAAS,GAAGzC,SAAS;AAAA,yEAAC,kBAAO0C,GAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,mBAEpB7B,OAFoB;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAGNA,OAAO,CAAC;AAAEmB,gBAAAA,MAAM,EAAE,KAAV;AAAiBC,gBAAAA,GAAG,EAAEhC,GAAG,CAAC0C,QAAJ,CAAaD,GAAb;AAAtB,eAAD,CAHD;;AAAA;AAGlBN,cAAAA,GAHkB;AAIlBD,cAAAA,IAJkB,GAIXC,GAJW,aAIXA,GAJW,oCAIXA,GAAG,CAAED,IAJM,8CAIX,UAAWA,IAJA,EAKtB;;AACAd,cAAAA,iBAAiB,CAACc,IAAD,CAAjB;;AANsB;AAAA;AAAA;;AAAA;AAAA;AAAA;AASxBE,cAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ;;AATwB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAD;;AAAA;AAAA;AAAA;AAAA,OAWxB,GAXwB,CAA3B;;AAaA,MAAMM,SAAS,GAAG,SAAZA,SAAY,CAACC,aAAD,EAAgBC,SAAhB,EAA8B;AAC9C;AACA9B,IAAAA,iBAAiB,IAAIA,iBAAiB,CAAC6B,aAAD,CAAtC;AACD,GAHD;;AAKA,sBACE;AACE,IAAA,KAAK,EAAC,0BADR;AAEE,IAAA,OAAO,EAAEnC,OAFX;AAGE,IAAA,IAAI,EAAEmB,KAHR;AAIE,IAAA,QAAQ,EAAEd,QAJZ;AAKE,IAAA,UAAU,EAAC,cALb;AAME,IAAA,MAAM,EAAC,cANT;AAOE,IAAA,cAAc,EAAEO;AAPlB,kBAUI,wCACMpB,MADN;AAEE,IAAA,IAAI,EAAEiB,IAFR;AAGE,IAAA,IAAI,EAAC,OAHP;AAIE,IAAA,aAAa,EAAE;AAAE4B,MAAAA,QAAQ,EAAE;AAAZ,KAJjB;AAKE,IAAA,cAAc,EAAEH,SALlB,CAME;AACA;;AAPF,mBASE,0BAAM,IAAN;AACE,IAAA,KAAK,EAAC,oBADR;AAEE,IAAA,IAAI,EAAC,cAFP;AAGE,IAAA,KAAK,EAAE,CAAC;AAAEI,MAAAA,QAAQ,EAAE,IAAZ;AAAkBC,MAAAA,OAAO,EAAE;AAA3B,KAAD;AAHT,kBAKE;AACE,IAAA,UAAU,MADZ;AAEE,IAAA,WAAW,EAAC,gCAFd;AAGE,IAAA,gBAAgB,EAAC,UAHnB,CAIE;AAJF;AAKE,IAAA,QAAQ,EAAER;AALZ,KAOGrB,cAAc,CAAC8B,GAAf,CAAmB,UAACC,CAAD,EAAIC,CAAJ;AAAA,wBAClB,4BAAQ,MAAR;AAAe,MAAA,GAAG,EAAEA,CAApB;AAAuB,MAAA,KAAK,EAAED,CAAC,CAACE;AAAhC,OACMF,CAAC,CAACG,IADR,WACkBH,CAAC,CAACI,KADpB,CADkB;AAAA,GAAnB,CAPH,CALF,CATF,eA6BE,0BAAM,IAAN;AACE,IAAA,KAAK,EAAC,0BADR;AAEE,IAAA,IAAI,EAAC,SAFP;AAGE,IAAA,KAAK,EAAE,CAAC;AAAEP,MAAAA,QAAQ,EAAE,IAAZ;AAAkBC,MAAAA,OAAO,EAAE;AAA3B,KAAD;AAHT,kBAKE;AACE,IAAA,IAAI,EAAC,UADP;AAEE,IAAA,WAAW,EAAC,sCAFd,CAGE;;AAHF,KAKGhC,YAAY,CAACiC,GAAb,CAAiB,UAACC,CAAD,EAAIC,CAAJ;AAAA,wBAChB,4BAAQ,MAAR;AAAe,MAAA,GAAG,EAAEA,CAApB;AAAuB,MAAA,KAAK,EAAED,CAAC,CAACvB;AAAhC,OACMuB,CAAC,CAACK,QADR,WACsBL,CAAC,CAACM,SADxB,CADgB;AAAA,GAAjB,CALH,CALF,CA7BF,eA+CE,0BAAM,IAAN;AACE,IAAA,KAAK,EAAC,0BADR;AAEE,IAAA,IAAI,EAAC,QAFP;AAGE,IAAA,KAAK,EAAE,CAAC;AAAET,MAAAA,QAAQ,EAAE,IAAZ;AAAkBC,MAAAA,OAAO,EAAE;AAA3B,KAAD;AAHT,kBAKE,2BAAO,QAAP;AACE,IAAA,IAAI,EAAE,CADR;AAEE,IAAA,WAAW,EAAC;AAFd,IALF,CA/CF,CAVJ,CADF;AAwED","sourcesContent":["import React, { useEffect, useState, useRef, useCallback } from \"react\";\n\nimport { Button, Input, Modal, Select, Form, message, Spin } from \"antd\";\nimport _debounce from \"lodash.debounce\";\nimport api from \"../api\";\n\nconst layout = {\n  labelCol: { span: 4 },\n  wrapperCol: { span: 18 },\n};\n\nconst tailLayout = {\n  wrapperCol: { offset: 8, span: 16 },\n};\n\nexport default function FlowTransferModal(props) {\n  const {\n    visible,\n    remark,\n    setRemark,\n    request,\n    onOk,\n    onCancel,\n    onModelFormChange,\n    runTimeTasks = [],\n  } = props;\n\n  const [form] = Form.useForm();\n  const [targetUserList, setTargetUserList] = useState([]);\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    if (visible) {\n    }\n    return () => {};\n  }, [visible]);\n\n  useEffect(() => {\n    form.setFieldsValue({ reason: remark });\n    return () => {};\n  }, [remark]);\n\n  useEffect(() => {\n    if (runTimeTasks.length) {\n      // console.log(remark)\n      form.setFieldsValue({ taskIds: [runTimeTasks[0]?.taskId] });\n    }\n    return () => {};\n  }, [runTimeTasks]);\n\n  const _onOk = async () => {\n    if (request) {\n      try {\n        setLoading(true);\n        const values = await form.validateFields();\n        const res = await request({\n          method: \"POST\",\n          url: api.taskTransfer(),\n          data: { ...values },\n        });\n        console.log(\"values:\", values);\n        form.resetFields();\n        message.success(res.data.data);\n        if (typeof onOk === \"function\") onOk(values);\n        // console.log(\"Success:\", values);\n      } catch (errorInfo) {\n        console.log(\"Failed:\", errorInfo);\n      } finally {\n        setLoading(false);\n      }\n    }\n  };\n\n  const _onSearch = _debounce(async (val) => {\n    try {\n      if (request) {\n        let res = await request({ method: \"GET\", url: api.userList(val) });\n        let data = res?.data?.data;\n        // console.log(data);\n        setTargetUserList(data);\n      }\n    } catch (errorInfo) {\n      console.log(\"Failed:\", errorInfo);\n    }\n  }, 300);\n\n  const _onChange = (changedValues, allValues) => {\n    // setRemark && setRemark(changedValues.reason);\n    onModelFormChange && onModelFormChange(changedValues);\n  };\n\n  return (\n    <Modal\n      title=\"流程转办\"\n      visible={visible}\n      onOk={_onOk}\n      onCancel={onCancel}\n      cancelText=\"取消\"\n      okText=\"确定\"\n      confirmLoading={loading}\n    >\n      {/* <Spin spinning={true}> */}\n        <Form\n          {...layout}\n          form={form}\n          name=\"basic\"\n          initialValues={{ remember: true }}\n          onValuesChange={_onChange}\n          // onFinish={onFinish}\n          // onFinishFailed={onFinishFailed}\n        >\n          <Form.Item\n            label=\"转办人\"\n            name=\"targetUserId\"\n            rules={[{ required: true, message: \"请选择转办人\" }]}\n          >\n            <Select\n              showSearch\n              placeholder=\"选择转办人\"\n              optionFilterProp=\"children\"\n              // onChange={onChange}\n              onSearch={_onSearch}\n            >\n              {targetUserList.map((d, i) => (\n                <Select.Option key={i} value={d.id}>\n                  {`${d.name} - ${d.login}`}\n                </Select.Option>\n              ))}\n            </Select>\n          </Form.Item>\n\n          <Form.Item\n            label=\"流程节点\"\n            name=\"taskIds\"\n            rules={[{ required: true, message: \"请选择流程节点\" }]}\n          >\n            <Select\n              mode=\"multiple\"\n              placeholder=\"选择流程节点\"\n              // onChange={onChange}\n            >\n              {runTimeTasks.map((d, i) => (\n                <Select.Option key={i} value={d.taskId}>\n                  {`${d.nodeName} - ${d.userNames}`}\n                </Select.Option>\n              ))}\n            </Select>\n          </Form.Item>\n\n          <Form.Item\n            label=\"转办理由\"\n            name=\"reason\"\n            rules={[{ required: true, message: \"请输入转办理由\" }]}\n          >\n            <Input.TextArea\n              rows={4}\n              placeholder=\"请输入转办理由\"\n            ></Input.TextArea>\n          </Form.Item>\n        </Form>\n      {/* </Spin> */}\n    </Modal>\n  );\n}\n"],"file":"index.js"}